{"version":3,"sources":["components/Facepile/Facepile.tsx"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;IA0BA,IAAM,MAAM,GAAQ,YAAY,CAAC;IAEjC;QAA8B,4BAAiC;QAS7D,kBAAY,KAAqB;YAAjC,YACE,kBAAM,KAAK,CAAC,SAIb;YAFC,KAAI,CAAC,kBAAkB,GAAG,iBAAK,EAAE,CAAC;;QAEpC,CAAC;QACM,yBAAM,GAAb;YAAA,iBA6CC;YA5CK,IAAA,eASU,EARZ,0CAAkB,EAClB,kDAAsB,EACtB,4CAAmB,EACnB,0CAAkB,EAClB,oCAAe,EACf,wBAAS,EACT,sBAAQ,EACR,gCAAa,CACA;YACf,IAAI,iBAAiB,GAAW,IAAI,CAAC,GAAG,CAAC,QAAQ,CAAC,MAAM,EAAE,sBAAsB,CAAC,CAAC;YAElF,mEAAmE;YACnE,EAAE,CAAC,CAAC,kBAAkB,IAAI,CAAC,mBAAmB,CAAC,CAAC,CAAC;gBAC/C,mBAAmB,GAAG,kBAAkB,CAAC;gBACzC,kBAAkB,GAAG,mCAAkB,CAAC,SAAS,CAAC;YACpD,CAAC;YAED,MAAM,CAAC,CACL,6BAAK,SAAS,EAAG,eAAG,CAAC,aAAa,EAAE,MAAM,CAAC,IAAI,EAAE,SAAS,CAAC;gBACzD,6BACE,SAAS,EAAG,eAAG,CAAC,2BAA2B,EAAE,MAAM,CAAC,aAAa,CAAC;oBAEhE,aAAa,GAAG,IAAI,CAAC,iBAAiB,EAAE,GAAG,IAAI;oBAC/C,IAAI,CAAC,uBAAuB,EAAE;oBAChC,oBAAC,qBAAS,IACR,eAAe,EAAG,IAAI,CAAC,kBAAkB,EACzC,IAAI,EAAC,SAAS,EACd,SAAS,EAAG,eAAG,CAAC,qBAAqB,EAAE,MAAM,CAAC,OAAO,CAAC,EACtD,SAAS,EAAG,8BAAkB,CAAC,UAAU,IAGvC,QAAQ,CAAC,KAAK,CAAC,CAAC,EAAE,iBAAiB,CAAC,CAAC,GAAG,CAAC,UAAC,OAAyB,EAAE,KAAa;wBAChF,IAAM,cAAc,GAAgB,KAAI,CAAC,kBAAkB,CAAC,OAAO,CAAC,CAAC;wBACrE,MAAM,CAAC,OAAO,CAAC,OAAO;4BACpB,KAAI,CAAC,2BAA2B,CAAC,cAAc,EAAE,OAAO,EAAE,KAAK,CAAC;4BAChE,KAAI,CAAC,8BAA8B,CAAC,cAAc,EAAE,OAAO,EAAE,KAAK,CAAC,CAAC;oBACxE,CAAC,CAAC,CAEM;oBACV,mBAAmB,GAAG,IAAI,CAAC,mBAAmB,CAAC,iBAAiB,CAAC,GAAG,IAAI,CACtE,CACF,CACP,CAAC;QACJ,CAAC;QAES,0CAAuB,GAAjC;YACU,IAAA,4CAAe,CAAgB;YAEvC,sFAAsF;YACtF,oDAAoD;YACpD,MAAM,CAAC,eAAe,IAAI,CACxB,8BAAM,SAAS,EAAG,MAAM,CAAC,gBAAgB,EAAG,EAAE,EAAG,IAAI,CAAC,kBAAkB,IAAK,eAAe,CAAS,CACtG,CAAC;QACJ,CAAC;QAEO,qCAAkB,GAA1B,UAA2B,OAAyB;YAC9C,IAAA,eAA6C,EAA3C,oCAAe,EAAE,4BAAW,CAAgB;YAClD,MAAM,CAAC,oBAAC,iBAAO,aACb,aAAa,EAAG,OAAO,CAAC,aAAa,EACrC,QAAQ,EAAG,OAAO,CAAC,QAAQ,EAC3B,aAAa,EAAG,OAAO,CAAC,aAAa,EACrC,WAAW,EAAG,OAAO,CAAC,WAAW,EACjC,IAAI,EAAG,WAAW,EAClB,kBAAkB,EAAG,IAAI,IACrB,CAAC,eAAe,GAAG,eAAe,CAAC,OAAO,CAAC,GAAG,IAAI,CAAC,EACvD,CAAC;QACL,CAAC;QAEO,8CAA2B,GAAnC,UAAoC,cAA2B,EAAE,OAAyB,EAAE,KAAa;YACvG,MAAM,CAAC,oBAAC,mBAAU,eACX,0BAAc,CAAC,OAAO,EAAE,4BAAgB,CAAC,IAC9C,GAAG,EAAG,CAAC,CAAC,CAAC,OAAO,CAAC,QAAQ,GAAG,GAAG,GAAG,EAAE,CAAC,GAAG,KAAK,uBACzB,IAAI,EACxB,IAAI,EAAC,QAAQ,EACb,SAAS,EAAG,eAAG,CAAC,2CAA2C,EAAE,MAAM,CAAC,UAAU,CAAC,EAC/E,KAAK,EAAG,OAAO,CAAC,WAAW,EAC3B,OAAO,EAAG,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,IAAI,EAAE,OAAO,CAAC,EAClD,WAAW,EAAG,IAAI,CAAC,mBAAmB,CAAC,IAAI,CAAC,IAAI,EAAE,OAAO,CAAC,EAC1D,UAAU,EAAG,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,IAAI,EAAE,OAAO,CAAC,KAEtD,cAAc,CACL,CAAC;QAChB,CAAC;QAEO,iDAA8B,GAAtC,UAAuC,cAA2B,EAAE,OAAyB,EAAE,KAAa;YAC1G,MAAM,CAAC,wCACA,0BAAc,CAAC,OAAO,EAAE,yBAAa,CAAC,IAC3C,GAAG,EAAG,CAAC,CAAC,CAAC,OAAO,CAAC,QAAQ,GAAG,GAAG,GAAG,EAAE,CAAC,GAAG,KAAK,uBACzB,IAAI,EACxB,IAAI,EAAC,QAAQ,EACb,SAAS,EAAG,eAAG,CAAC,2CAA2C,EAAE,MAAM,CAAC,UAAU,CAAC,EAC/E,KAAK,EAAG,OAAO,CAAC,WAAW,EAC3B,WAAW,EAAG,IAAI,CAAC,mBAAmB,CAAC,IAAI,CAAC,IAAI,EAAE,OAAO,CAAC,EAC1D,UAAU,EAAG,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,IAAI,EAAE,OAAO,CAAC,KAEtD,cAAc,CACZ,CAAC;QACT,CAAC;QAEO,sCAAmB,GAA3B,UAA4B,iBAAyB;YACnD,MAAM,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,kBAAkB,CAAC,CAAC,CAAC;gBACtC,KAAK,mCAAkB,CAAC,WAAW;oBACjC,MAAM,CAAC,IAAI,CAAC,8BAA8B,CAAC,iBAAiB,CAAC,CAAC;gBAChE,KAAK,mCAAkB,CAAC,SAAS;oBAC/B,MAAM,CAAC,IAAI,CAAC,eAAe,CAAC,aAAa,CAAC,CAAC;gBAC7C,KAAK,mCAAkB,CAAC,IAAI;oBAC1B,MAAM,CAAC,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC,CAAC;gBACtC;oBACE,MAAM,CAAC,IAAI,CAAC;YAChB,CAAC;QACH,CAAC;QAEO,iDAA8B,GAAtC,UAAuC,iBAAyB;YAC1D,IAAA,eAA2D,EAAzD,4CAAmB,EAAE,sBAAQ,EAAE,4BAAW,CAAgB;YAChE,IAAI,sBAAsB,GAAW,QAAQ,CAAC,MAAM,GAAG,iBAAiB,CAAC;YAEzE,EAAE,CAAC,CAAC,CAAC,mBAAmB,IAAI,sBAAsB,GAAG,CAAC,CAAC,CAAC,CAAC;gBAAC,MAAM,CAAC,IAAI,CAAC;YAAC,CAAC;YAExE,IAAI,YAAY,GAAW,QAAQ,CAAC,KAAK,CAAC,iBAAiB,CAAC,CAAC,GAAG,CAAC,UAAC,CAAmB,IAAK,OAAA,CAAC,CAAC,WAAW,EAAb,CAAa,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YAEpH,MAAM,CAAC,oBAAC,mBAAU,eACX,mBAAmB,IACxB,eAAe,EAAG,YAAY,EAC9B,SAAS,EAAG,eAAG,CAAC,uCAAuC,EAAE,wBAAwB,EAAE,MAAM,CAAC,yBAAyB,EAAE,MAAM,CAAC,UAAU,CAAC;gBAEvI,oBAAC,iBAAO,IACN,KAAK,EAAG,YAAY,EACpB,IAAI,EAAG,WAAW,EAClB,kBAAkB,EAAG,IAAI,EACzB,gBAAgB,EAAG;wBACjB,MAAM,CAAC,CACL,kCAAQ,GAAG,GAAG,sBAAsB,CAAS,CAC9C,CAAC;oBACJ,CAAC,GACD,CACS,CAAC;QAChB,CAAC;QAEO,kCAAe,GAAvB,UAAwB,IAAY;YAC9B,IAAA,eAAiD,EAA/C,4CAAmB,EAAE,4BAAW,CAAgB;YAEtD,MAAM,CAAC,oBAAC,mBAAU,eACZ,mBAAmB,IACvB,SAAS,EAAG,eAAG,CAAC,4BAA4B,EAAE,wBAAwB,EAAE,MAAM,CAAC,cAAc,EAAE,MAAM,CAAC,UAAU,CAAC;gBAEjH,oBAAC,iBAAO,IACN,IAAI,EAAG,WAAW,EAClB,kBAAkB,EAAG,IAAI,EACzB,gBAAgB,EAAG,cAAM,OAAA,CACvB,2BAAG,SAAS,EAAG,eAAG,CAAC,SAAS,EAAE,QAAQ,EAAE,sBAAoB,IAAM,CAAC,iBAAe,MAAM,GAAG,CAC5F,EAFwB,CAExB,GACD,CACS,CAAC;QAChB,CAAC;QAEO,oCAAiB,GAAzB;YACM,IAAA,eAA4C,EAA1C,kCAAc,EAAE,4BAAW,CAAgB;YACjD,MAAM,CAAC,oBAAC,mBAAU,eACZ,cAAc,IAClB,SAAS,EAAG,eAAG,CAAC,uBAAuB,EAAE,wBAAwB,EAAE,MAAM,CAAC,UAAU,EAAE,MAAM,CAAC,SAAS,CAAC;gBAEvG,oBAAC,iBAAO,IACN,IAAI,EAAG,WAAW,EAClB,kBAAkB,EAAG,IAAI,EACzB,gBAAgB,EAAG,cAAM,OAAA,CACvB,2BAAG,SAAS,EAAC,mCAAmC,iBAAa,MAAM,GAAG,CACvE,EAFwB,CAExB,GACD,CACS,CAAC;QAChB,CAAC;QAEO,kCAAe,GAAvB,UAAwB,OAAyB,EAAE,EAAkC;YACnF,OAAO,CAAC,OAAO,CAAC,EAAE,EAAE,OAAO,CAAC,CAAC;YAC7B,EAAE,CAAC,cAAc,EAAE,CAAC;YACpB,EAAE,CAAC,eAAe,EAAE,CAAC;QACvB,CAAC;QAEO,sCAAmB,GAA3B,UAA4B,OAAyB,EAAE,EAAkC;YACvF,EAAE,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,WAAW,CAAC,CAAC,CAAC;gBAC1B,OAAO,CAAC,WAAW,CAAC,EAAE,EAAE,OAAO,CAAC,CAAC;YACnC,CAAC;QACH,CAAC;QAEO,qCAAkB,GAA1B,UAA2B,OAAyB,EAAE,EAAkC;YACtF,EAAE,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,UAAU,CAAC,CAAC,CAAC;gBACzB,OAAO,CAAC,UAAU,CAAC,EAAE,EAAE,OAAO,CAAC,CAAC;YAClC,CAAC;QACH,CAAC;QACH,eAAC;IAAD,CA7MA,AA6MC,CA7M6B,yBAAa;IAC3B,qBAAY,GAAmB;QAC3C,sBAAsB,EAAE,CAAC;QACzB,QAAQ,EAAE,EAAE;QACZ,WAAW,EAAE,qBAAW,CAAC,UAAU;KACpC,CAAC;IALS,4BAAQ","file":"components/Facepile/Facepile.js","sourcesContent":["import * as React from 'react';\r\nimport {\r\n  BaseComponent,\r\n  buttonProperties,\r\n  css,\r\n  divProperties,\r\n  getId,\r\n  getNativeProps\r\n} from '../../Utilities';\r\nimport {\r\n  IFacepileProps,\r\n  IFacepilePersona,\r\n  OverflowButtonType\r\n} from './Facepile.Props';\r\nimport {\r\n  FocusZone,\r\n  FocusZoneDirection\r\n} from '../../FocusZone';\r\nimport {\r\n  BaseButton\r\n} from '../../Button';\r\nimport {\r\n  Persona,\r\n  PersonaSize\r\n} from '../../Persona';\r\nimport * as stylesImport from './Facepile.scss';\r\nconst styles: any = stylesImport;\r\n\r\nexport class Facepile extends BaseComponent<IFacepileProps, {}> {\r\n  public static defaultProps: IFacepileProps = {\r\n    maxDisplayablePersonas: 5,\r\n    personas: [],\r\n    personaSize: PersonaSize.extraSmall\r\n  };\r\n\r\n  private _ariaDescriptionId: string;\r\n\r\n  constructor(props: IFacepileProps) {\r\n    super(props);\r\n\r\n    this._ariaDescriptionId = getId();\r\n\r\n  }\r\n  public render(): JSX.Element {\r\n    let {\r\n      chevronButtonProps,\r\n      maxDisplayablePersonas,\r\n      overflowButtonProps,\r\n      overflowButtonType,\r\n      ariaDescription,\r\n      className,\r\n      personas,\r\n      showAddButton\r\n    } = this.props;\r\n    let numPersonasToShow: number = Math.min(personas.length, maxDisplayablePersonas);\r\n\r\n    // Added for deprecating chevronButtonProps.  Can remove after v1.0\r\n    if (chevronButtonProps && !overflowButtonProps) {\r\n      overflowButtonProps = chevronButtonProps;\r\n      overflowButtonType = OverflowButtonType.downArrow;\r\n    }\r\n\r\n    return (\r\n      <div className={ css('ms-Facepile', styles.root, className) }>\r\n        <div\r\n          className={ css('ms-Facepile-itemContainer', styles.itemContainer) }\r\n        >\r\n          { showAddButton ? this._getAddNewElement() : null }\r\n          { this.onRenderAriaDescription() }\r\n          <FocusZone\r\n            ariaDescribedBy={ this._ariaDescriptionId }\r\n            role='listbox'\r\n            className={ css('ms-Facepile-members', styles.members) }\r\n            direction={ FocusZoneDirection.horizontal }\r\n          >\r\n            {\r\n              personas.slice(0, numPersonasToShow).map((persona: IFacepilePersona, index: number) => {\r\n                const personaControl: JSX.Element = this._getPersonaControl(persona);\r\n                return persona.onClick ?\r\n                  this._getElementWithOnClickEvent(personaControl, persona, index) :\r\n                  this._getElementWithoutOnClickEvent(personaControl, persona, index);\r\n              })\r\n            }\r\n          </FocusZone>\r\n          { overflowButtonProps ? this._getOverflowElement(numPersonasToShow) : null }\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  protected onRenderAriaDescription() {\r\n    const { ariaDescription } = this.props;\r\n\r\n    // If ariaDescription is given, descriptionId will be assigned to ariaDescriptionSpan,\r\n    // otherwise it will be assigned to descriptionSpan.\r\n    return ariaDescription && (\r\n      <span className={ styles.screenReaderOnly } id={ this._ariaDescriptionId }>{ ariaDescription }</span>\r\n    );\r\n  }\r\n\r\n  private _getPersonaControl(persona: IFacepilePersona): JSX.Element {\r\n    let { getPersonaProps, personaSize } = this.props;\r\n    return <Persona\r\n      imageInitials={ persona.imageInitials }\r\n      imageUrl={ persona.imageUrl }\r\n      initialsColor={ persona.initialsColor }\r\n      primaryText={ persona.personaName }\r\n      size={ personaSize }\r\n      hidePersonaDetails={ true }\r\n      {...(getPersonaProps ? getPersonaProps(persona) : null) }\r\n    />;\r\n  }\r\n\r\n  private _getElementWithOnClickEvent(personaControl: JSX.Element, persona: IFacepilePersona, index: number): JSX.Element {\r\n    return <BaseButton\r\n      { ...getNativeProps(persona, buttonProperties) }\r\n      key={ (!!persona.imageUrl ? 'i' : '') + index }\r\n      data-is-focusable={ true }\r\n      role='option'\r\n      className={ css('ms-Facepile-itemButton ms-Facepile-person', styles.itemButton) }\r\n      title={ persona.personaName }\r\n      onClick={ this._onPersonaClick.bind(this, persona) }\r\n      onMouseMove={ this._onPersonaMouseMove.bind(this, persona) }\r\n      onMouseOut={ this._onPersonaMouseOut.bind(this, persona) }\r\n    >\r\n      { personaControl }\r\n    </BaseButton>;\r\n  }\r\n\r\n  private _getElementWithoutOnClickEvent(personaControl: JSX.Element, persona: IFacepilePersona, index: number): JSX.Element {\r\n    return <div\r\n      { ...getNativeProps(persona, divProperties) }\r\n      key={ (!!persona.imageUrl ? 'i' : '') + index }\r\n      data-is-focusable={ true }\r\n      role='option'\r\n      className={ css('ms-Facepile-itemButton ms-Facepile-person', styles.itemButton) }\r\n      title={ persona.personaName }\r\n      onMouseMove={ this._onPersonaMouseMove.bind(this, persona) }\r\n      onMouseOut={ this._onPersonaMouseOut.bind(this, persona) }\r\n    >\r\n      { personaControl }\r\n    </div>;\r\n  }\r\n\r\n  private _getOverflowElement(numPersonasToShow: number): JSX.Element {\r\n    switch (this.props.overflowButtonType) {\r\n      case OverflowButtonType.descriptive:\r\n        return this._getDescriptiveOverflowElement(numPersonasToShow);\r\n      case OverflowButtonType.downArrow:\r\n        return this._getIconElement('ChevronDown');\r\n      case OverflowButtonType.more:\r\n        return this._getIconElement('More');\r\n      default:\r\n        return null;\r\n    }\r\n  }\r\n\r\n  private _getDescriptiveOverflowElement(numPersonasToShow: number): JSX.Element {\r\n    let { overflowButtonProps, personas, personaSize } = this.props;\r\n    let numPersonasNotPictured: number = personas.length - numPersonasToShow;\r\n\r\n    if (!overflowButtonProps || numPersonasNotPictured < 1) { return null; }\r\n\r\n    let personaNames: string = personas.slice(numPersonasToShow).map((p: IFacepilePersona) => p.personaName).join(', ');\r\n\r\n    return <BaseButton\r\n      { ...overflowButtonProps}\r\n      ariaDescription={ personaNames }\r\n      className={ css('ms-Facepile-descriptiveOverflowButton', 'ms-Facepile-itemButton', styles.descriptiveOverflowButton, styles.itemButton) }\r\n    >\r\n      <Persona\r\n        title={ personaNames }\r\n        size={ personaSize }\r\n        hidePersonaDetails={ true }\r\n        onRenderInitials={ () => {\r\n          return (\r\n            <span>{ '+' + numPersonasNotPictured }</span>\r\n          );\r\n        } }\r\n      />\r\n    </BaseButton>;\r\n  }\r\n\r\n  private _getIconElement(icon: string): JSX.Element {\r\n    let { overflowButtonProps, personaSize } = this.props;\r\n\r\n    return <BaseButton\r\n      {...overflowButtonProps}\r\n      className={ css('ms-Facepile-overflowButton', 'ms-Facepile-itemButton', styles.overflowButton, styles.itemButton) }\r\n    >\r\n      <Persona\r\n        size={ personaSize }\r\n        hidePersonaDetails={ true }\r\n        onRenderInitials={ () => (\r\n          <i className={ css('ms-Icon', 'msIcon', `ms-Icon ms-Icon--${icon}`) } aria-hidden='true' />\r\n        ) }\r\n      />\r\n    </BaseButton>;\r\n  }\r\n\r\n  private _getAddNewElement(): JSX.Element {\r\n    let { addButtonProps, personaSize } = this.props;\r\n    return <BaseButton\r\n      {...addButtonProps}\r\n      className={ css('ms-Facepile-addButton', 'ms-Facepile-itemButton', styles.itemButton, styles.addButton) }\r\n    >\r\n      <Persona\r\n        size={ personaSize }\r\n        hidePersonaDetails={ true }\r\n        onRenderInitials={ () => (\r\n          <i className='ms-Icon msIcon ms-Icon--AddFriend' aria-hidden='true' />\r\n        ) }\r\n      />\r\n    </BaseButton>;\r\n  }\r\n\r\n  private _onPersonaClick(persona: IFacepilePersona, ev?: React.MouseEvent<HTMLElement>): void {\r\n    persona.onClick(ev, persona);\r\n    ev.preventDefault();\r\n    ev.stopPropagation();\r\n  }\r\n\r\n  private _onPersonaMouseMove(persona: IFacepilePersona, ev?: React.MouseEvent<HTMLElement>): void {\r\n    if (!!persona.onMouseMove) {\r\n      persona.onMouseMove(ev, persona);\r\n    }\r\n  }\r\n\r\n  private _onPersonaMouseOut(persona: IFacepilePersona, ev?: React.MouseEvent<HTMLElement>): void {\r\n    if (!!persona.onMouseOut) {\r\n      persona.onMouseOut(ev, persona);\r\n    }\r\n  }\r\n}\r\n"],"sourceRoot":"..\\..\\..\\src"}